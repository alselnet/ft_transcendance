(()=>{"use strict";var t,e={980:(t,e,n)=>{const o=()=>{document.querySelectorAll(".nav-link").forEach((t=>{t.classList.remove("active")}));const t=location.hash,e=document.querySelector(`.nav-link[href="${t}"]`);e&&e.classList.add("active")};function s(t){for(let e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(n,2)}function a(t){return function(e){return 1-t(1-e)}}function i({timing:t,draw:e,duration:n}){let o=performance.now();requestAnimationFrame((function s(a){let i=(a-o)/n;i>1&&(i=1);let r=t(i);e(r),i<1&&requestAnimationFrame(s)}))}function r(){window.location.href="https://localhost/api/auth/42login/"}const l=n.p+"images/4330a4f692ec0ede7355.png",c=()=>{if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let t=document.querySelector(".navbar-container");t&&t.remove();let e=document.querySelector(".logout-container");e&&e.remove();let n=document.querySelector("#section");n&&(n.innerHTML=`\n        <div class="balls-home d-none d-md-flex">\n            <div class="orange-ball-home">\n                <a href="#/signin" data-hash="signin">\n                    Inscription\n                </a>\n            </div>\n            <div class="white-ball-home">\n                <a href="#/login" data-hash="login">\n                    Connexion\n                </a>\n            </div>\n            <div class="btn-container-home">\n                <button id="fortyTwoSignInBtn" class="btn-42-home">\n                    <p class="co-42-home">connexion avec</p>\n                    <img src="${l}" class="img-42-home" alt="button-42">\n                </button>\n            </div>\n        </div>\n\n        <div class="balls-home-sm d-none d-sm-flex d-md-none">\n            <div class="orange-ball-home-sm">\n                <a href="#/signin" data-hash="signin">\n                    Inscription\n                </a>\n            </div>\n            <div class="white-ball-home-sm">\n                <a href="#/login" data-hash="login">\n                    Connexion\n                </a>\n            </div>\n            <div class="btn-container-home">\n                <button id="fortyTwoSignInBtnSm" class="btn-42-home">\n                    <p class="co-42-home">connexion avec</p>\n                    <img src="${l}" class="img-42-home" alt="button-42">\n                </button>\n            </div>\n        </div>\n        `);const o=document.querySelector(".white-ball-home"),c=document.querySelector(".orange-ball-home");o&&c?function(t,e,n){e.style.position="absolute",n.style.position="absolute",e.style.top="0",n.style.top="0";const o=(t.clientHeight-e.clientHeight)/2,r=(t.clientHeight-n.clientHeight)/2;i({duration:2e3,timing:a(s),draw(t){e.style.transform=`translateY(${o*t}px)`}}),setTimeout((()=>{i({duration:2e3,timing:a(s),draw(t){n.style.transform=`translateY(${r*t}px)`}})}),1e3)}(n,o,c):console.error(".white-ball-home or .orange-ball-home not found in the DOM");const d=document.getElementById("fortyTwoSignInBtn"),u=document.getElementById("fortyTwoSignInBtnSm");d?d.addEventListener("click",(()=>{r()})):console.error("#fortyTwoSignInBtn not found in the DOM"),u?u.addEventListener("click",(()=>{r()})):console.error("#fortyTwoSignInBtnSm not found in the DOM")};function d(t){let e=("; "+document.cookie).split("; "+t+"=");if(2===e.length)return e.pop().split(";").shift()}var u=n(964);const m=()=>({"Content-Type":"application/json","X-CSRFToken":d("csrftoken"),Authorization:`Bearer ${localStorage.getItem("accessToken")}`}),p=async()=>{const t=localStorage.getItem("accessToken"),e=localStorage.getItem("refreshToken");if(!t)return window.location.hash="#/",!1;if(n=t,!(JSON.parse(atob(n.split(".")[1])).exp<Date.now()/1e3))return!0;var n;if(!e)return window.location.hash="#/",!1;console.log("Refreshing token");const o=await fetch("https://localhost/api/auth/token/refresh/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":d("csrftoken")},body:JSON.stringify({refresh:e})});if(!o.ok)return console.log("Failed to fetch access token from server"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.hash="#/",!1;const s=await o.json();return localStorage.setItem("accessToken",s.access),!0},h=async(t,e={})=>{if(!await p())throw new Error("User is not authenticated");return e.method="GET",e.headers={...m(),...e.headers},fetch(t,e)},v=async(t,e,n={})=>{if(!await p())throw new Error("User is not authenticated");return n.method="POST",n.headers={...m(),...n.headers},n.body=JSON.stringify(e),fetch(t,n)},g=async(t,e,n={})=>{if(!await p())throw new Error("User is not authenticated");return n.method="PUT",n.headers={...m(),...n.headers},n.body=JSON.stringify(e),fetch(t,n)},f=async(t,e={})=>{if(!await p())throw new Error("User is not authenticated");return e.method="DELETE",e.headers={...m(),...e.headers},fetch(t,e)},y=async()=>{if(!await p())throw new Error("User is not authenticated");let t=document.querySelector("#section");if(t){t.innerHTML='   \n        <div class="game-container" id="game-container">\n            <div class="score-container">\n                <span id="score-player1">Player 1: 0</span>\n                <span id="score-player2">Player 2: 0</span>\n            </div>\n            <canvas id="game-canvas" width="1200" height="700"></canvas>\n        <div class="button-container" id="initial-buttons">\n            <button class="game-button" id="local-mode">Local</button>\n            <button class="game-button" id="tournoi-mode">Tournoi</button>\n        </div>\n        <div class="button-container" id="settings">\n            <div>\n                <label for="ball-speed">Ball Speed:</label>\n                <select id="ball-speed">\n                    <option value="15">Slow</option>\n                    <option value="20">Normal</option>\n                    <option value="25">Fast</option>\n                </select>\n            </div>\n            <div>\n                <label for="paddle-speed">Paddle Speed:</label>\n                <select id="paddle-speed">\n                    <option value="5">Slow</option>\n                    <option value="7">Normal</option>\n                    <option value="10">Fast</option>\n                </select>\n            </div>\n            <div>\n                <label for="background-color">Background Color:</label>\n                <select id="background-color">\n                    <option value="black">Black</option>\n                    <option value="blue">Blue</option>\n                    <option value="green">Green</option>\n                </select>\n            </div>\n            <button class="game-button" id="start-game-btn">Start Game</button>\n        </div>\n        <div class="button-container" id="tournoi-buttons">\n            <button class="game-button" id="three-players-btn">3 Players</button>\n            <button class="game-button" id="four-players-btn">4 Players</button>\n            <button class="game-button" id="five-players-btn">5 Players</button>\n        </div>\n    </div>\n    ';const e=document.getElementById("initial-buttons"),n=document.getElementById("tournoi-buttons"),o=document.getElementById("local-mode"),s=document.getElementById("tournoi-mode"),a=document.getElementById("settings"),i=document.getElementById("start-game-btn"),r=document.getElementById("ball-speed"),l=document.getElementById("paddle-speed"),c=document.getElementById("background-color"),d=document.getElementById("game-canvas");if(!d)return void console.error("Failed to find the canvas element with ID game-canvas");let m,g,f,b,w,E,k,S,$,L,x,T,I,_,q,B,M,F;let A=!1;async function O(){m=0,g=0,f=0,b=0,w=null,E={},k=[],B=0,M=0;const t=await h("https://localhost/api/users/me/"),e=await t.json();console.log(e),F=e.username,console.log(F),Z(B,M)}function j(){e.classList.add("hidden"),n.classList.add("hidden"),a.classList.add("hidden")}function C(){P(),Z(0,0),j(),a.classList.remove("hidden")}function P(){console.log("Dans init game"),$=new u.Z58,L=new u.ubm(75,window.innerWidth/window.innerHeight,.1,1e3),S=new u.JeP({canvas:d}),S.setSize(window.innerWidth,window.innerHeight),S.setClearColor(4690117);const t=new u.$p8(16777215,.2);$.add(t);const e=new u.ZyN(16777215,1);e.position.set(0,500,200),$.add(e);const n=new u.HiM(16777215,.5,0,2);n.position.set(-_/2,50,-q/2),$.add(n);const o=new u.HiM(16777215,.5,0,2);o.position.set(_/2,50,-q/2),$.add(o);const s=new u.HiM(16777215,.5,0,2);s.position.set(-_/2,50,q/2),$.add(s);const a=new u.HiM(16777215,.5,0,2);a.position.set(_/2,50,q/2),$.add(a);const i=new u.nCl(16777215,.7,0,Math.PI/4,.5,2);i.position.set(0,300,0),i.target.position.set(0,0,0),$.add(i),$.add(i.target);const r=new u.nCl(16777215,.7,0,Math.PI/4,.5,2);r.position.set(0,300,0),r.target.position.set(0,0,q/2),$.add(r),$.add(r.target),_=1200,q=700;const l=new u.tXL({color:16777215});x=new u.eaF(new u.iNn(10,10,70),l),T=new u.eaF(new u.iNn(10,10,70),l),x.position.set(-_/2+10,5,0),T.position.set(_/2-10,5,0),$.add(x),$.add(T);const c=new u.tXL({color:16711680});I=new u.eaF(new u.Gu$(5,32,32),c),I.position.set(0,5,0),$.add(I);const m=_,p=new u.tXL({color:16777215}),h=new u.eaF(new u.iNn(m,15,10),p),v=new u.eaF(new u.iNn(m,15,10),p);h.position.set(0,7.5,q/2+5),v.position.set(0,7.5,-q/2-5),$.add(h),$.add(v);const g=new u.tXL({color:16777215}),f=new u.iNn(10,1,10),y=[];for(let t=-q/2+20;t<q/2;t+=40){const e=new u.eaF(f,g);e.position.set(0,1,t),y.push(e),$.add(e)}L.position.set(0,600,500),L.lookAt(new u.Pq0(0,0,0)),S.render($,L)}function D(t){console.log("inside prompte player name"),k=[];for(let e=1;e<=t;e++){const t=prompt(`Player ${e} name:`);if(null===t)return console.log("Player input cancelled. Tournament not started."),void C();""===t.trim()?(alert("Please enter a valid name."),e--):k.push(t.trim())}for(let e=0;e<t;e++)console.log("player name:",k[e]);H(k)}async function H(t){let e=1;for(;t.length>1;){console.log(`Round ${e}:`);let n=[];if(t.length%2!=0){let e=t.pop();n.push(e),console.log(`${e} advances to the next round automatically`)}for(let o=0;o<t.length;o+=2){let s=t[o],a=t[o+1];const i=`local_match_${s}_vs_${a}`.replace(/[^a-zA-Z0-9_]/g,"");j(),alert(`Round: ${e}  Match: ${s} Vs ${a}`),await U(i,s,a,n,r.value,l.value)}t=n,e++}alert(`Tournament Winner: ${t[0]}`),j(),C()}function N(t,e,n){w&&w.close(),A=!1,w=new WebSocket(`wss://localhost/ws/pong/${t}/`),w.onopen=function(t){console.log("Connected to the server"),w.send(JSON.stringify({type:"config",ball_speed:e,paddle_speed:n})),w.send(JSON.stringify({type:"start_ball"}))},w.onmessage=async function(t){const e=JSON.parse(t.data);if("game_state"===e.type)W(e);else if("start_game"===e.type)console.log("The game has started!");else if("game_over"===e.type){A=!0,console.log("Fin de game"),alert(`Player ${e.winner} wins!`);let t={winner_username:"",loser_username:"",winner_score:0,loser_score:0,perfect:!1,local_game:!0};console.log(e),1==e.winner?(t.winner_username=F,t.loser_username="Player2",t.winner_score=e.score_player1,t.loser_score=e.score_player2,0==e.score_player2&&(t.perfect=!0)):(t.winner_username="Player2",t.loser_username=F,t.winner_score=e.score_player2,t.loser_score=e.score_player1,0==e.score_player1&&(t.perfect=!0)),console.log(t);try{const e=await v("https://localhost/api/users/game-history/",t),n=await e.json();e.ok?console.log("Game history updated successfully:",n):console.error("Error updating game history:",n)}catch(t){console.error("Fetch error:",t)}z(500),j(),C()}},w.onclose=function(t){console.log("Disconnected from the server")},w.onerror=function(t){console.error(`WebSocket error: ${t.message}`)},document.addEventListener("keydown",(function(t){E[t.code]=!0,R()})),document.addEventListener("keyup",(function(t){E[t.code]=!1}))}function z(t=500){w&&setTimeout((()=>{w.close(),w=null}),t)}function U(t,e,n,o,s,a){return w&&w.close(),A=!1,new Promise(((i,r)=>{w=new WebSocket(`wss://localhost/ws/pong/${t}/`),w.onopen=function(t){console.log("Connected to the server"),w.send(JSON.stringify({type:"config",ball_speed:s,paddle_speed:a}))},w.onmessage=function(t){const s=JSON.parse(t.data);if("game_state"===s.type)J(s,e,n);else if("start_game"===s.type)console.log("The game has started!");else if("game_over"===s.type){let t;console.log("Fin de game"),A=!0,t=1==s.winner?e:n,alert(`${e} vs ${n} - Winner: ${t}`),o.push(t),w.close(),w=null,j(),i()}},w.onclose=function(t){console.log("Disconnected from the server")},w.onerror=function(t){console.error(`WebSocket error: ${t.message}`),r(t)},document.addEventListener("keydown",(function(t){E[t.code]=!0,R()})),document.addEventListener("keyup",(function(t){E[t.code]=!1}))}))}function R(){w&&w.readyState===WebSocket.OPEN&&!1===A&&(E.ArrowUp&&w.send(JSON.stringify({type:"move",player:2,direction:"up"})),E.ArrowDown&&w.send(JSON.stringify({type:"move",player:2,direction:"down"})),E.KeyW&&w.send(JSON.stringify({type:"move",player:1,direction:"up"})),E.KeyS&&w.send(JSON.stringify({type:"move",player:1,direction:"down"})),E.Space&&w.send(JSON.stringify({type:"start_ball"})))}function J(t,e,n){m=t.player1_y_position,g=t.player2_y_position,f=t.ball_x_position,b=t.ball_y_position,B=t.score_player1,M=t.score_player2,V(B,M,e,n),X(e,n)}function W(t){m=t.player1_y_position,g=t.player2_y_position,f=t.ball_x_position,b=t.ball_y_position,B=t.score_player1,M=t.score_player2,Z(B,M),G()}function Z(t,e){document.getElementById("score-player1").textContent=`${F}: ${t}`,document.getElementById("score-player2").textContent=`Invité: ${e}`}function V(t,e,n,o){document.getElementById("score-player1").textContent=`${n}: ${t}`,document.getElementById("score-player2").textContent=`${o}: ${e}`}function X(t,e){S.render($,L),x.position.z=m,T.position.z=g,I.position.x=f,I.position.z=b,S.render($,L)}function G(){S.render($,L),x.position.z=m,T.position.z=g,I.position.x=f,I.position.z=b,S.render($,L)}function Y(){R(),requestAnimationFrame(Y)}function K(){m=0,g=0,f=0,b=0,B=0,M=0,A=!1,Z(B,M)}O(),C(),i.addEventListener("click",(function(){document.getElementById("game-canvas").style.backgroundColor=c.value,j(),e.classList.remove("hidden")})),o.addEventListener("click",(function(){console.log("inside local"),j();const t="local_"+(new Date).getTime();console.log(t),N(t,r.value,l.value)})),document.getElementById("three-players-btn").addEventListener("click",(()=>D(3))),document.getElementById("four-players-btn").addEventListener("click",(()=>D(4))),document.getElementById("five-players-btn").addEventListener("click",(()=>D(5))),s.addEventListener("click",(function(){console.log("inside tournoi"),j(),n.classList.remove("hidden")})),Y(),window.addEventListener("popstate",(function(){console.log("fermeture de la socket"),w&&(w.close(),w=null,K())})),window.addEventListener("hashchange",(function(){"#/game"===location.hash?y():w&&(w.close(),w=null,K())}))}},b=async()=>{if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let t=document.querySelector(".navbar-container");t&&t.remove();let e=document.querySelector(".logout-container");e&&e.remove();try{const t=await h("https://localhost/api/users/friendlist/");if(!t.ok)throw new Error("Failed to fetch user friendlist");const e=await t.json(),n=Array.isArray(e)?e:[],o=n.map((t=>`\n            <tr class="friend-row">\n                <td>\n                    <a href="#/friendprofile/${t.username}">\n                        <img src="${t.avatar}" alt="${t.username}">\n                    </a>\n                </td>\n                <td>\n                    <span class="status-circle" style="background-color: ${function(t){switch(t){case"online":return"green";case"offline":default:return"grey";case"in-game":return"orange"}}(t.status)};" data-tooltip="${function(t){switch(t){case"online":return"En ligne";case"offline":return"Déconnecté";case"in-game":return"En partie";default:return"Unknown Status"}}(t.status)}"></span>\n                </td>\n                <td>\n                    <a href="#/friendprofile/${t.username}" class="userf">${t.username}</a>\n                </td>\n                <td>\n                    <span class="remove-btnf" data-username="${t.username}">&times;</span>\n                </td>\n            </tr>\n        `)).join("");let s=document.querySelector("#section");s&&(s.innerHTML=`\n                <div class="main-containerf fl-hidden">\n                    <div class="friends-containerf">\n                        <h2 class="titlef">LISTE D'AMIS</h2>\n                        <a class="nav-link" href="#/dashboard">\n                            <span class="close-btnf">&times;</span>\n                        </a>\n                        <table class="friends-tablef">\n                            <tbody>\n                                ${o}\n                            </tbody>\n                        </table>\n                        <div class="friend-count">\n                            Nombre d'amis: ${n.length}\n                        </div>\n                    </div>\n                </div>\n            `);const a=document.querySelector(".main-containerf");a&&setTimeout((()=>{a.classList.add("fl-visible"),a.classList.remove("fl-hidden")}),10);document.querySelectorAll(".remove-btnf").forEach((t=>{t.addEventListener("click",(async e=>{const n=t.getAttribute("data-username");await async function(t){const e=`https://localhost/api/users/unfriend/${t}/`;try{const t=await f(e);if(!t.ok){const e=await t.json();throw new Error(e.detail||"Failed to remove friend")}const n=await t.json();console.log(n),alert("Friend removed successfully")}catch(t){console.error("Error removing friend:",t),alert(t.message||"Failed to remove friend")}}(n),b()}))}))}catch(t){console.error("Error fetching friend list:",t)}};const w=async()=>{if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let t=document.querySelector(".navbar-container");t&&t.remove();let e=document.querySelector(".logout-container");e&&e.remove();try{const t=await h("https://localhost/api/users/game-history/");if(!t.ok)throw new Error("Failed to fetch game history");const e=await t.json(),n=Array.isArray(e)?e:[],o=e.length>0?e[0].user:"",s=n.map((t=>{const e=t.winner_avatar,n=t.loser_avatar,s=t.local_game?"Locale":"Online",a=t.winner===o?"Victory":"Defeat",i=t.winner===o?"victory":"defeat";return`\n                <tr>\n                    <td>${new Date(t.date_time).toLocaleDateString()}</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="#/friendprofile/${t.winner}">\n\t\t\t\t\t\t\t<img src="${e}" alt="${t.winner}" class ="avatar"> ${t.winner}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="#/friendprofile/${t.loser}">\n\t\t\t\t\t\t\t<img src="${n}" alt="${t.loser}" class ="avatar"> ${t.loser}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</td>\n                    <td class="${i}">${a}</td>\n                    <td>${s}</td>\n                    <td>${t.winner_score} - ${t.loser_score}</td>\n                </tr>\n            `})).join("");let a=document.querySelector("#section");if(a){a.innerHTML=`\n                <div class="main-container2 ga-hidden">\n                    <h1 class="title2">Match History</h1>\n                    <div class="history-container2">\n                        <a class="nav-link" href="#/dashboard" id="game-history-button">\n                            <span class="close-btn2" id="close-btn">&times;</span>\n                        </a>\n                        <table class="history-table2">\n                            <thead>\n                                <tr>\n                                    <th>Date</th>\n                                    <th>Winner</th>\n                                    <th>Loser</th>\n                                    <th>Result</th>\n                                    <th>Game Mode</th>\n                                    <th>Score</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${s}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            `;const t=document.querySelector(".main-container2");t&&setTimeout((()=>{t.classList.add("ga-visible"),t.classList.remove("ga-hidden")}),10)}}catch(t){console.error("Error fetching game history:",t)}};function E(t,e,n,o,s){let a=document.createElement("div");a.style.width=0,a.style.height=0,a.style.left=e+"px",a.style.top=n+"px",a.style.borderRadius="50%",a.style.position="absolute",a.style.transition="width 0.5s ease, height 0.5s ease, left 0.5s ease, top 0.5s ease",t.appendChild(a),console.log("Circle div added to DOM:",a),setTimeout((()=>{a.style.width=2*o+"px",a.style.height=2*o+"px",a.style.left=e-o+"px",a.style.top=n-o+"px",console.log("Circle animation started"),s(a)}),10)}function k(t,e,n,o=""){console.log("Setting up camembert animation");const s=t.querySelector(".camembert-stat");if(!s)return void console.error("Camembert container not found");console.log("Camembert container found",s),s.innerHTML="";const a=s.getBoundingClientRect().width,i=a/2;E(s,i,i,i,(t=>{o?function(t,e,n){const o=e/2,s=o,a=`\n        <svg width="${e}" height="${e}" viewBox="0 0 ${e} ${e}" xmlns="http://www.w3.org/2000/svg">\n            <circle cx="${s}" cy="${s}" r="${o}" fill="#fef86c" style="transform-origin: ${s}px ${s}px; transform: scale(0); transition: transform 0.5s ease;"/>\n            <text x="${s}" y="${s}" text-anchor="middle" dominant-baseline="middle" font-size="10" fill="#9e9d9d" style="opacity: 0; transition: opacity 0.5s ease 0.5s;">\n                ${n}\n            </text>\n        </svg>\n    `;t.innerHTML=a,setTimeout((()=>{const e=t.querySelector("circle"),n=t.querySelector("text");e.style.transform="scale(1)",console.log("Full circle animation started"),setTimeout((()=>{n.style.opacity=1,console.log("Text animation started")}),510)}),10)}(t,a,o):setTimeout((()=>{!function(t,e,n,o){const s=e/2,a=s,i=n/100*360,r=i*Math.PI/180,l=`\n        <svg width="${e}" height="${e}" viewBox="0 0 ${e} ${e}" xmlns="http://www.w3.org/2000/svg">\n            <circle cx="${a}" cy="${a}" r="${s}" fill="transparent"/>\n            <circle cx="${a}" cy="${a}" r="${s}" fill="${o}" style="transform-origin: ${a}px ${a}px; transform: scale(0); transition: transform 0.5s ease;"/>\n            <path d="\n        M ${a},${a}\n        L ${a},${a-s}\n        A ${s},${s} 0 ${i>180?1:0} 1 ${a+s*Math.cos(r-Math.PI/2)},${a+s*Math.sin(r-Math.PI/2)}\n        Z\n    " fill="#b26969" style="transform-origin: ${a}px ${a}px; transform: scale(0); transition: transform 0.5s ease 0.5s;"/>\n        </svg>\n    `;t.innerHTML=l,setTimeout((()=>{t.querySelector("circle:nth-of-type(2)").style.transform="scale(1)",console.log("Full circle animation started")}),10),setTimeout((()=>{t.querySelector("path").style.transform="scale(1)",console.log("Sector animation started")}),510)}(t,a,e,n)}),500)}))}const S=(t,e)=>{let n=0;const o=e/100,s=setInterval((()=>{n+=o,n>=e&&(clearInterval(s),n=e),t.textContent=Math.floor(n)}),10)};function $(t){switch(t){case"online":return"green";case"offline":return"grey";case"in game":return"orange";default:return"red"}}const L=(t,e)=>t===e,x=async()=>{if(!await p())throw new Error("User is not authenticated");let t=document.querySelector("#section");t.innerHTML="",t.append((()=>{let t=document.createElement("div");return console.log("Creating form element"),h("https://localhost/api/users/me/").then((t=>{if(!t.ok)throw new Error("Failed to fetch user profile");return t.json()})).then((e=>{console.log("Fetched user data:",e),t.innerHTML=`\n\t\t\t<div class="stat-container">\n\t\t\t\t<div class="id">\n\t\t\t\t\t<div><img src="${e.avatar}" alt="profile-pic" class="profile-picture"></div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="text-stat">\n\t\t\t\t\t\t<div class="name-and-settings">\n\t\t\t\t\t\t\t<div class="username-stat">${e.username}</div>\n\t\t\t\t\t\t\t<a class="nav-link" href="#/settings"><i class="bi bi-gear-fill gear-icon"></i></a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="status">\n\t\t\t\t\t\t\t<div class="dropdown">\n\t\t\t\t\t\t\t\t<button class="btn btn-secondary dropdown-toggle transparent-dropdown d-flex align-items-center" type="button"\n\t\t\t\t\t\t\t\t\tid="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">\n\t\t\t\t\t\t\t\t\t<div class="status-dropdown">\n\t\t\t\t\t\t\t\t\t\t<div class="status-pastille" style="background-color: ${$(e.status)};"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="status-text">${e.status}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<ul class="dropdown-menu transparent-dropdown" aria-labelledby="dropdownMenuButton1">\n\t\t\t\t\t\t\t\t\t<li class="dropdown-item" data-status="online">\n\t\t\t\t\t\t\t\t\t\t<div class="status-dropdown">\n\t\t\t\t\t\t\t\t\t\t\t<div class="status-pastille" style="background-color: green; margin-right: 0.3vw"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div class="status-text">Online</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t<li class="dropdown-item" data-status="offline">\n\t\t\t\t\t\t\t\t\t\t<div class="status-dropdown">\n\t\t\t\t\t\t\t\t\t\t\t<div class="status-pastille" style="background-color: grey; margin-right: 0.3vw"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div class="status-text">Offline</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</div>            \n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="statistics-box">\n\t\t\t\t\t<div class="left-side">\n\t\t\t\t\t\t<div class="stat-title">Statistiques du joueur :</div>\n\t\t\t\t\t\t<div class="camembert-stat"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="middle">\n            \t\t    <div class="legend-stat">\n                    \t\t<div style="width: 1vw; height: 1vw; background-color: #63aa63; margin-right: 0.5vw; border-radius: 50%; margin-top: 0.2vw;"></div>\n                    \t\t<p>victoires</p>\n                \t\t</div>\n                \t\t<div class="legend-stat">\n                    \t\t<div style="width: 1vw; height: 1vw; background-color: #b26969; margin-right: 0.5vw; border-radius: 50%; margin-top: 0.2vw;"></div>\n                    \t\t<p>défaites</p>\n                \t\t</div>\n            \t\t</div>\n\t\t\t\t\t<div class="right-side">\n\t\t\t\t\t\t<div class="stat-data">\n\t\t\t\t\t\t\t<div class="stat-rubric-stat">\n\t\t\t\t\t\t\t\t<p class="stat-text">Points marqués</p>\n\t\t\t\t\t\t\t\t<p class="stat-number" data-target="${e.scored_points}">0</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="stat-rubric-stat">\n\t\t\t\t\t\t\t\t<p class="stat-text">Points concédés</p>\n\t\t\t\t\t\t\t\t<p class="stat-number" data-target="${e.conceded_points}">0</p>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="stat-rubric-stat">\n\t\t\t\t\t\t\t\t<p class="stat-text">Victoires parfaites</p>\n\t\t\t\t\t\t\t\t<p class="stat-number" data-target="${e.perfect_wins}">0</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="footer-link">\n\t\t\t\t\t<div class="search-container">\n            \t\t\t<div class="search-barre">\n                \t\t\t<input type="text" id="login-search" placeholder="Entrez le nom de l'utilisateur">\n            \t\t\t</div>\n            \t\t\t<button type="button" id="search-button">\n                \t\t\t<i class="bi bi-search search-icon"></i>\n            \t\t\t</button>\n        \t\t\t</div>\n\t\t\t\t\t<a class="nav-link" href="#/friendlist">         \n\t\t\t\t\t\t<div class="footer" id="list-stat">\n\t\t\t\t\t\t\t<i class="bi bi-list-task footer-icon"></i>\n\t\t\t\t\t\t\t<p class="footer-text">Liste d'amis</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t\t<a class="nav-link" href="#/gamehistory">         \n\t\t\t\t\t\t<div class="footer" id="history-stat">\n\t\t\t\t\t\t\t<i class="bi bi-clock-history footer-icon"></i>\n\t\t\t\t\t\t\t<p class="footer-text">Historique des parties</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n        `,console.log("Form innerHTML set"),setTimeout((()=>{t.querySelectorAll(".stat-number").forEach((t=>{const e=+t.getAttribute("data-target");S(t,e)})),console.log("Animation set")}),500),t.querySelectorAll(".dropdown-item").forEach((n=>{n.addEventListener("click",(()=>{const o=n.getAttribute("data-status");g("https://localhost/api/users/update-status/",{status:o}).then((t=>{if(!t.ok)throw new Error("Failed to update user status");return t.json()})).then((()=>{e.status=o;const n=t.querySelector(".status-text"),s=t.querySelector(".status-pastille");n&&s&&(n.innerText=o,s.style.backgroundColor=$(o))})).catch((t=>{console.error("Error updating status:",t)}))}))})),console.log("Event listeners set");const n=t.querySelector("#login-search"),o=t.querySelector("#search-button"),s=()=>{const t=n.value;t&&(L(t,e.username)?alert("Vous ne pouvez pas accéder à votre propre profil."):window.location.href=`#/friendprofile/${t}`,n.value="")};o.addEventListener("click",s),n.addEventListener("keydown",(t=>{"Enter"===t.key&&s()}));let a=0,i="#63aa63",r="";0!==e.played_games?a=100*(e.played_games-e.won_games)/e.played_games:(i="#fef86c",r="aucune partie jouée"),k(t,a,i,r),window.addEventListener("resize",(()=>{k(t,a,i,r)}))})).catch((e=>{console.error("Error fetching user profile:",e),t.innerHTML="<p>Failed to load user profile</p>"})),t})()),function(t){const e=t.querySelector("#list-stat");e?e.addEventListener("click",(()=>{let t=document.createElement("div");t.style.position="fixed",t.style.left=0,t.style.top=0,t.style.width="100%",t.style.height="100%",t.style.zIndex=1e3,document.body.append(t);let n=e.getBoundingClientRect(),o=n.left+n.width/2,s=n.top+n.height/2,a=Math.max(window.innerWidth,window.innerHeight);E(t,o,s,a,(e=>{let n=b();n.style.opacity=0,n.style.transition="opacity 0.5s",e.append(n),setTimeout((()=>{n.style.opacity=1}),0),n.querySelector(".close-button").addEventListener("click",(()=>{n.style.opacity=0,n.addEventListener("transitionend",(function o(){n.removeEventListener("transitionend",o),hideCircle(e,(()=>t.remove()))}))}))}))})):console.error("List button not found")}(t),function(t){const e=t.querySelector("#history-stat");e?e.addEventListener("click",(()=>{let t=document.createElement("div");t.style.position="fixed",t.style.left=0,t.style.top=0,t.style.width="100%",t.style.height="100%",t.style.zIndex=1e3,document.body.append(t);let n=e.getBoundingClientRect(),o=n.left+n.width/2,s=n.top+n.height/2,a=Math.max(window.innerWidth,window.innerHeight);E(t,o,s,a,(e=>{let n=w();n.style.opacity=0,n.style.transition="opacity 0.5s",e.append(n),setTimeout((()=>{n.style.opacity=1}),0),n.querySelector(".close-button").addEventListener("click",(()=>{n.style.opacity=0,n.addEventListener("transitionend",(function o(){n.removeEventListener("transitionend",o),hideCircle(e,(()=>t.remove()))}))}))}))})):console.error("History button not found")}(t)},T=t=>{console.log("Update 2FA Method"),v("https://localhost/api/auth/update-2fa/",{method:t}).then((t=>t.ok?t.json().then((t=>{alert("2FA method updated successfully"),window.location.reload()})):t.json().then((t=>{alert(`Error: ${t.error||"Failed to update 2FA method"}`)})))).catch((t=>{console.error("Error updating 2FA method:",t),alert("An error occurred while updating the 2FA method")}))},I=async()=>{let t=document.createElement("div");if(!await p())throw new Error("User is not authenticated");return h("https://localhost/api/users/me/").then((t=>{if(!t.ok)throw new Error("Failed to fetch user profile");return t.json()})).then((t=>{var e;console.log("Fetched user data:",t),section.innerHTML=`\n            <div class="settings-container">\n                <h1 class="settings-title">Parametre du compte</h1>\n                <div class="settings-box">\n                    <div class="editting">\n                        <img src="${t.avatar}" class="settings-picture" alt="settings-pic">\n                        <a href="#" class="edit-pp">modifier</a>\n                        <input type="file" id="avatar-input" style="display: none;" accept="image/*">\n                    </div>\n                    <div class="modif-username">\n                        <p id="username-display">${t.username}</p>\n                        <button type="button" id="edit-username" class="btn btn-light">modifier username</button>\n                    </div>\n                    <div class="modif-username">\n                        <p id="email-display">${t.email}</p>\n                        <button type="button" id="edit-email" class="btn btn-light">modifier adresse mail</button>\n                    </div>\n                    <div class="modif-username">\n                        <p>********</p>\n                        <button type="button" class="btn btn-light">modifier mot de passe</button>\n                    </div>\n\n                    <div class="dropdown">\n                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">\n                        methode 2fa\n                        </button>\n                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">\n                        <li><a class="dropdown-item" id="tfa-none">aucune</a></li>\n                        <li><a class="dropdown-item" id="tfa-email">mail</a></li>\n                        <li><a class="dropdown-item" id="tfa-authenticator">qrcode</a></li>\n                        </ul>\n                    </div>\n\n                    <div class="dropdown">\n                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">\n                        couleur de l'arriere plan\n                        </button>\n                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">\n                        <li><a class="dropdown-item" href="#">Nagoya</a></li>\n                        <li><a class="dropdown-item" href="#">Roland</a></li>\n                        <li><a class="dropdown-item" href="#">Wimbledon</a></li>\n                        </ul>\n                    </div>\n                    \n                    <button type="button" href="#" class="btn btn-danger delete-account">supprimer le compte</button>\n\n                </div>\n\n                <div class="settings-footer">\n                    \n                    <div class="search-container">\n                        <div class="search-barre">\n                            <input type="text" id="login-search" placeholder="Entrez le nom de l'utilisateur">\n                        </div>\n                        <button type="button" id="search-button">\n                            <i class="bi bi-search search-icon"></i>\n                        </button>\n                    </div>\n\n                    <a class="nav-link" href="#/confidentalite">         \n                        <div class="settings-footer" id="list-stat">\n                            <i class="bi bi-file-earmark-lock settings-footer-icon"></i>\n                            <p class="settings-footer-text">Charte de confidentialite</p>\n                        </div>\n                    </a>\n                </div>\n\n                <div class="confirm-email">\n                    votre adresse mail doit etre verifiee : \n                    <a href="" id="resend-verification-email">renvoyer un mail de verification</a>\n                </div>\n\n            </div>\n\n        `,section.querySelector(".edit-pp").addEventListener("click",(t=>{t.preventDefault(),section.querySelector("#avatar-input").click()})),section.querySelector("#avatar-input").addEventListener("change",(t=>{const e=t.target.files[0];e&&(t=>{const e=new FormData;e.append("avatar",t),fetch("https://localhost/api/users/update-avatar/",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:e}).then((t=>t.ok?t.json():t.json().then((t=>{throw new Error(t.error||"Failed to update avatar")})))).then((t=>{document.querySelector(".settings-picture").src=t.avatar,alert("Avatar updated successfully"),window.location.reload()})).catch((t=>{console.error("Error updating avatar:",t),alert("An error occurred while updating the avatar")}))})(e)})),section.querySelector("#resend-verification-email").addEventListener("click",(e=>{var n;e.preventDefault(),n=t.email,console.log("Send Mail"),v("https://localhost/api/auth/send-confirmation-email/",{email:n}).then((t=>{if(!t.ok)return t.json().then((t=>{alert(`Error: ${t.error||"Failed to send confirmation email"}`)}));alert("Confirmation email sent")})).catch((t=>{console.error("Error sending confirmation email:",t),alert("An error occurred while sending the confirmation email")}))})),section.querySelector("#edit-username").addEventListener("click",(e=>{const n=prompt("Entrez le nouveau nom d'utilisateur :",t.username);n&&n!==t.username&&(t=>{console.log("Update Username"),g("https://localhost/api/users/update-username/",{username:t}).then((t=>t.ok?t.json().then((t=>{document.querySelector("#username-display").textContent=t.username,alert("Username updated successfully"),window.location.reload()})):t.json().then((t=>{alert(`Error: ${t.error||"Failed to update username"}`)})))).catch((t=>{console.error("Error updating username:",t),alert("An error occurred while updating the username")}))})(n)})),section.querySelector("#edit-email").addEventListener("click",(e=>{const n=prompt("Entrez la nouvelle adresse mail :",t.email);n&&n!==t.email&&(t=>{console.log("Update Email"),g("https://localhost/api/users/update-email/",{email:t}).then((t=>t.ok?t.json().then((t=>{document.querySelector("#email-display").textContent=t.email,alert("Email updated successfully"),window.location.reload()})):t.json().then((t=>{alert(`Error: ${t.error||"Failed to update email"}`)})))).catch((t=>{console.error("Error updating email:",t),alert("An error occurred while updating the email")}))})(n)})),section.querySelector("#tfa-none").addEventListener("click",(()=>{T("none")})),section.querySelector("#tfa-email").addEventListener("click",(()=>{T("email")})),section.querySelector("#tfa-authenticator").addEventListener("click",(()=>{T("authenticator")})),section.querySelector(".delete-account").addEventListener("click",(()=>{confirm("Are you sure you want to delete your account? This action cannot be undone.")&&f("https://localhost/api/auth/delete-user/").then((t=>{if(!t.ok)return t.json().then((t=>{alert(`Error: ${t.error||"Failed to delete account"}`)}));alert("Account deleted successfully"),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.hash="#/"})).catch((t=>{console.error("Error deleting account:",t),alert("An error occurred while deleting the account")}))})),e=t.two_fa_method,document.querySelectorAll(".dropdown-item").forEach((t=>{t.classList.remove("active-2fa")})),document.querySelector(`#tfa-${e}`).classList.add("active-2fa")})).catch((e=>{console.error("Error fetching user profile:",e),t.innerHTML="<p>Failed to load user profile</p>"})),t},_=n.p+"images/2e33b274de877244a3da.png",q=n.p+"images/ce111bc7f40343a05d42.jpg",B=n.p+"images/0d8fb09bbcf1530a9616.png",M=n.p+"images/54682494f24ad7a85dec.png",F=()=>{console.log("enter in friendprofile component");let t=document.createElement("div");const e=window.location.hash.split("/"),n=e[e.length-1];return h(`https://localhost/api/users/${n}/`).then((t=>t.json())).then((e=>{if("No User matches the given query."===e.detail)throw new Error("L'utilisateur n'existe pas");console.log("Fetched user data:",e),t.innerHTML=`\n            <div class="stat-container">\n\t\t\t\t<div class="id">\n\t\t\t\t\t<div><img src="${e.avatar}" alt="profile-pic" class="profile-picture"></div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="text-stat">\n\t\t\t\t\t\t<div class="friend-name">\n\t                        <p class="profile-text">Profil de</p>\n\t\t\t\t\t\t\t<div class="friend-username-stat">${e.username}</div>\n\t\t\t\t\t\t</div>\n                        <div class="status">\n                            <div class="status-pastille" style="background-color: ${function(t){switch(t){case"online":return"green";case"offline":return"grey";case"in game":return"orange";default:return"red"}}(e.status)}; margin-top: 0.5vh;"></div>\n                            <div class="friend-status-text">${e.status}</div>\n                            <a class="nav-link" href="#" id="delete-friend-btn"><i class="bi bi-person-dash-fill person-icon delete-icon"></i></a>\n                            <a class="nav-link" href="#" id="add-friend-btn"><i class="bi bi-person-plus-fill person-icon"></i></a>\n                        </div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="statistics-box">\n\t\t\t\t\t<div class="left-side">\n\t\t\t\t\t\t<div class="stat-title">Statistiques du joueur :</div>\n\t\t\t\t\t\t<div class="camembert-stat"></div>\n\t\t\t\t\t</div>\n                    <div class="middle">\n            \t\t    <div class="legend-stat">\n                    \t\t<div style="width: 1vw; height: 1vw; background-color: #63aa63; margin-right: 0.5vw; border-radius: 50%; margin-top: 0.2vw;"></div>\n                    \t\t<p>victoires</p>\n                \t\t</div>\n                \t\t<div class="legend-stat">\n                    \t\t<div style="width: 1vw; height: 1vw; background-color: #b26969; margin-right: 0.5vw; border-radius: 50%; margin-top: 0.2vw;"></div>\n                    \t\t<p>défaites</p>\n                \t\t</div>\n            \t\t</div>\n\t\t\t\t\t<div class="right-side">\n\t\t\t\t\t\t<div class="stat-data">\n\t\t\t\t\t\t\t<div class="stat-rubric-stat">\n\t\t\t\t\t\t\t\t<p class="stat-text">Points marqués :</p>\n\t\t\t\t\t\t\t\t<p class="stat-number" data-target="${e.scored_points}">0</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="stat-rubric-stat">\n\t\t\t\t\t\t\t\t<p class="stat-text">Points concédés :</p>\n\t\t\t\t\t\t\t\t<p class="stat-number" data-target="${e.conceded_points}">0</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="stat-rubric-stat">\n\t\t\t\t\t\t\t\t<p class="stat-text">Victoires parfaites :</p>\n\t\t\t\t\t\t\t\t<p class="stat-number" data-target="${e.perfect_wins}">0</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="footer-friend-link">\n\t\t\t\t\t<div class="search-container">\n            \t\t\t<div class="search-barre">\n                \t\t\t<input type="text" id="login-search" placeholder="Entrez le nom de l'utilisateur">\n            \t\t\t</div>\n            \t\t\t<button type="button" id="search-button">\n                \t\t\t<i class="bi bi-search search-icon"></i>\n            \t\t\t</button>\n        \t\t\t</div>\n\t\t\t\t\t<a class="nav-link" href="#/publicgamehistory/${e.username}">         \n\t\t\t\t\t\t<div class="footer-friend" id="history-stat">\n\t\t\t\t\t\t\t<i class="bi bi-clock-history footer-friend-icon"></i>\n\t\t\t\t\t\t\t<p class="footer-friend-text">Historique des parties de ${e.username}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\n\t\t\t</div>\n            `,setTimeout((()=>{t.querySelectorAll(".stat-number").forEach((t=>{const e=+t.getAttribute("data-target");S(t,e)}))}),500);let o=0,s="#63aa63",a="";0!==e.played_games?o=100*(e.played_games-e.won_games)/e.played_games:(s="#fef86c",a="aucune partie jouée"),k(t,o,s,a),window.addEventListener("resize",(()=>{k(t,o,s,a)}));const i=t.querySelector("#login-search"),r=t.querySelector("#search-button"),l=()=>{const t=i.value;t&&(A(t,e.username)?alert("Vous ne pouvez pas accéder à votre propre profil."):window.location.href=`#/friendprofile/${t}`,i.value="")};r.addEventListener("click",l),i.addEventListener("keydown",(t=>{"Enter"===t.key&&l()})),document.getElementById("delete-friend-btn").addEventListener("click",(t=>{t.preventDefault(),function(t){const e=`https://localhost/api/users/unfriend/${t}/`;f(e).then((t=>t.ok?t.json():t.json().then((t=>{throw new Error(t.detail||"Failed to remove friend")})))).then((t=>{console.log(t),alert("Friend removed successfully")})).catch((t=>{console.error("Error removing friend:",t),alert(t.message||"Failed to remove friend")}))}(n)})),document.getElementById("add-friend-btn").addEventListener("click",(t=>{t.preventDefault(),function(t){const e=`https://localhost/api/users/add-friend/${t}/`;v(e).then((t=>t.ok?t.json():t.json().then((t=>{throw new Error(t.detail||"Failed to add friend")})))).then((t=>{console.log(t),alert("Friend added successfully")})).catch((t=>{console.error("Error adding friend:",t),alert(t.message||"Failed to add friend")}))}(n)}))})).catch((t=>{console.error("Error fetching user profile:",t),alert("L'utilisateur n'existe pas"),window.location.href="#/dashboard"})),t};const A=(t,e)=>t===e;const O=async()=>{try{if(!(await v("https://localhost/api/auth/signout/")).ok)throw new Error("Failed to logout");localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="#/"}catch(t){console.error("Logout error:",t),alert("An error occurred while logging out. Please try again.")}},j=["#/game","#/dashboard","#/settings","#/aboutus","#/chartemsg","#/friendlist","#/gamehistory"],C=["#/friendprofile","#/publicgamehistory"],P=async()=>{const t=window.location.hash;console.log("current hash: ",t);const e=document.getElementById("section");window.isInternalNavigation=!0;const n=j.includes(t),o=C.some((e=>t.startsWith(e)));if(window.onbeforeunload=n||o?function(t){v("https://localhost/api/auth/signout/")}:null,window.location.hash.includes("access")&&window.location.hash.includes("refresh"))return console.log("handling callback"),void await function(){console.log("handleCallback()");const t=window.location.hash.substring(1);console.log("Fragment part of URL:",t);const e=new URLSearchParams(t),n=e.get("access"),o=e.get("refresh"),s=e.get("message");if(n&&o){console.log("Tokens found in URL parameters:",n,o);try{localStorage.setItem("accessToken",n),localStorage.setItem("refreshToken",o),console.log("Tokens stored successfully in local storage.")}catch(t){console.error("Error storing tokens in local storage:",t)}s&&alert(s),window.location.href="https://localhost/#/dashboard"}else console.log("No tokens found in URL parameters.")}();"#/"===t?c():"#/signin"===t?(()=>{if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let t=document.querySelector(".navbar-container");t&&t.remove();let e=document.querySelector(".logout-container");e&&e.remove();let n=document.querySelector("#section");n&&(n.innerHTML=`\n            <div class="balls-signin d-none d-md-flex">\n                <div class="white-ball-signin"></div>\n                    \n                <div class="orange-ball-signin">\n                    <form id="signin-form" class="login-form-signin">\n                        <input type="text" id="username" placeholder="nom d'utilisateur">\n                        <input type="email" id="email" placeholder="email">\n                        <input type="password" id="password" placeholder="mot de passe">\n                        <input type="password" id="confirmPassword" placeholder="confirmer mdp">\n                        <button type="submit" class="button-signin">s'inscrire</button>\n                    </form>\n                    \n                    <a class="nav-link" href="#/">\n                        <div class="arrow-s"><i class="bi bi-arrow-left-circle-fill"></i></div>\n                    </a>\n\n                </div>\n\n                <div class="btn-container-home">\n                    <button id="fortyTwoSignInBtn" class="btn-42-home">\n                        <p class="co-42-home">connexion avec</p>\n                        <img src="${l}" class="img-42-home" alt="button-42">\n                    </button>\n                </div>\n            </div>\n\n            <div class="balls-signin d-none d-sm-flex d-md-none">\n                <a class="nav-link" href="#/">\n                    <div class="arrow-s-sm"><i class="bi bi-arrow-left-circle-fill"></i></div>\n                </a>\n                <div class="orange-ball-signin-sm">\n                    <form id="signin-form-sm" class="login-form-signin">\n                        <input type="text" id="username-sm" placeholder="nom d'utilisateur">\n                        <input type="email" id="email-sm" placeholder="email">\n                        <input type="password" id="password-sm" placeholder="mot de passe">\n                        <input type="password" id="confirmPassword-sm" placeholder="confirmer mdp">\n                        <button type="submit" class="button-signin">s'inscrire</button>\n                    </form>\n                </div>\n            </div>\n        `),(document.getElementById("signin-form")||document.getElementById("signin-form-sm")).addEventListener("submit",(t=>{t.preventDefault(),console.log("Form submitted");const e={username:document.getElementById("username").value||document.getElementById("username-sm").value,email:document.getElementById("email").value||document.getElementById("email-sm").value,password:document.getElementById("password").value||document.getElementById("password-sm").value,confirmPassword:document.getElementById("confirmPassword").value||document.getElementById("confirmPassword-sm").value};console.log("Form data:",e);const n=o(e.username),i=a(e.email),r=s(e.password);return n?i?r?e.password===e.confirmPassword?void fetch("https://localhost/api/auth/register/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":d("csrftoken")},body:JSON.stringify(e)}).then((t=>(console.log("Response status:",t.status),t.ok?t.json():t.json().then((t=>{throw new Error(t.message)}))))).then((t=>{console.log("Response data:",t),alert(t.message),localStorage.setItem("accessToken",t.access),localStorage.setItem("refreshToken",t.refresh),console.log("Redirecting to dashboard from signin..."),window.location.href="#/dashboard",console.log("Current hash:",window.location.hash)})).catch((t=>{console.error("Error:",t),alert("User creation failed.")})):(alert("confirmation de mot de passe incorrect"),void console.log("Passwords do not match")):(alert("mot de passe doit contenir au moins 8 caractères, une lettre, un chiffre et un caractère spécial."),void console.log("Invalid password")):(alert("email non conforme"),void console.log("Invalid email")):(alert("Le nom d'utilisateur peut avoir maximum 8 caractères"),void console.log("Invalid email"))}));const o=t=>/^[a-zA-Z0-9]{1,8}$/.test(t),s=t=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^a-zA-Z\d]).{8,}$/.test(t),a=t=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.+[a-zA-Z]{2,}$/.test(t);document.getElementById("fortyTwoSignInBtn").addEventListener("click",(()=>{r()}))})():"#/login"===t?(()=>{if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let t=document.querySelector(".navbar-container");t&&t.remove();let e=document.querySelector(".logout-container");e&&e.remove();let n=document.querySelector("#section");n&&(n.innerHTML=`\n        <div class="balls-login d-none d-md-flex">\n            <div class="orange-ball-login">\n                <a class="nav-link" href="#/">\n                    <div class="arrow"><i class="bi bi-arrow-left-circle-fill"></i></div>\n                </a>\n            </div>\n            <div class="white-ball-login">\n                <form id="login-form" class="login-form-login">\n                    <input type="text" id="username" placeholder="Username">\n                    <input type="password" id="password" placeholder="Password">\n                    <button type="submit" class="button-login">se connecter</button>\n                </form>\n            </div>\n\n            <div class="btn-container-home">\n                <button id="fortyTwoSignInBtn" class="btn-42-home">\n                    <p class="co-42-home">connexion avec</p>\n                    <img src="${l}" class="img-42-home" alt="button-42">\n                </button>\n            </div>\n        </div>\n\n        <div class="balls-login d-none d-sm-flex d-md-none">\n            <a class="nav-link" href="#/">\n                <div class="arrow-sm"><i class="bi bi-arrow-left-circle-fill"></i></div>\n            </a>\n        <div class="white-ball-login-sm">\n                <form id="login-form-sm" class="login-form-login"> \x3c!-- Ajout de la balise form --\x3e\n                    <input type="text" id="username-sm" placeholder="Username">\n                    <input type="password" id="password-sm" placeholder="Password">\n                    <button type="submit" class="button-login">se connecter</button>\n                </form>\n            </div>\n        </div>\n    `),(document.getElementById("login-form")||document.getElementById("login-form-sm")).addEventListener("submit",(t=>{t.preventDefault();const e={username:document.getElementById("username").value||document.getElementById("username-sm").value,password:document.getElementById("password").value||document.getElementById("password-sm").value};fetch("https://localhost/api/auth/signin/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":d("csrftoken")},body:JSON.stringify(e)}).then((t=>t.ok?t.json():t.json().then((t=>{throw new Error("Erreur de connexion")})))).then((t=>{console.log("Réponse du backend:",t),localStorage.setItem("accessToken",t.access),localStorage.setItem("refreshToken",t.refresh),console.log("Redirecting to dashboard from login..."),window.location.href="#/dashboard"})).catch((t=>{console.error("Erreur:",t),alert("Nom d utilisateur ou mot de passe incorrect")}))})),document.getElementById("fortyTwoSignInBtn").addEventListener("click",(()=>{r()}))})():"#/game"===t?y():"#/dashboard"===t?x():"#/settings"===t?I():"#/aboutus"===t?(async()=>{if(!await p())throw new Error("User is not authenticated");let t=document.querySelector("#section");t&&(t.innerHTML=`\n\t    <div class="main-container-aboutus">\n\n        <h1 class="title-aboutus">Qui sommes nous ?</h1>\n\t    <div class="container-aboutus">\n\t    \t<div class="row">\n\t    \t\t<div id="block2" class="col-md-6 col-lg-6 mb-3">\n\t\t\t\t\t<a class="nav-link" href="https://fr.linkedin.com/in/hugo-coulon-03a577294">\n\t\t    \t\t\t<div class="frame-aboutus">\n\t\t    \t\t\t\t<h1 class="name-cube">Hugo COULON</h1>\n\t    \t\t\t\t\t<img class="img-us" src="${_}" alt="img-hugo">\n\t    \t\t\t\t\t<p>Développement du jeu</p>\n\t    \t\t\t\t</div>\n\t\t\t\t\t</a>\n\t    \t\t</div>\n\t    \t\t<div id="block3" class="col-md-6 col-lg-6 mb-3">\n\t\t\t\t\t<a class="nav-link" href="https://fr.linkedin.com/in/tasnim-mejri-5a8460211?original_referer=https%3A%2F%2Fwww.google.com%2F">\n\t\t    \t\t\t<div class="frame-aboutus">\n\t\t    \t\t\t\t<h1 class="name-cube">Tasnim MEJRI</h1>\n\t    \t\t\t\t\t<img class="img-us" src="${q}" alt="img-tasnim">\n\t    \t\t\t\t\t<p>Développement du frontend</p>\n\t    \t\t\t\t</div>\n\t\t\t\t\t</a>\n\t    \t\t</div>\n\t    \t\t<div id="block4" class="col-md-6 col-lg-6 mb-3">\n\t\t\t\t\t<a class="nav-link" href="https://fr.linkedin.com/in/alexandre-selnet-1a1714317">\n\t    \t\t\t\t<div class="frame-aboutus">\n\t    \t\t\t\t\t<h1 class="name-cube">Alexandre SELNET</h1>\n\t    \t\t\t\t\t<img class="img-us" src="${B}" alt="img-alex">\n\t    \t\t\t\t\t<p>Développement Fullstack</p>\n\t    \t\t\t\t</div>\n\t\t\t\t\t</a>\n\t    \t\t</div>\n\t    \t\t<div id="block5" class="col-md-6 col-lg-6 mb-3">\n\t\t\t\t\t<a class="nav-link" href="https://fr.linkedin.com/in/jules-thuysbaert-535723204">\n\t    \t\t\t\t<div class="frame-aboutus">\n\t    \t\t\t\t\t<h1 class="name-cube">Jules THUYSBAERT</h1>\n\t    \t\t\t\t\t<img class="img-us" src="${M}" alt="img-jules">\n\t    \t\t\t\t\t<p>Développement du backend</p>\n\t    \t\t\t\t</div>\n\t\t\t\t\t</a>\n\t    \t\t</div>\n    \t\t</div>\n\t    </div>\n\t    </div>\n    `)})():"#/friendlist"===t?b():"#/gamehistory"===t?w():t.startsWith("#/publicgamehistory")?(async()=>{const t=window.location.hash.split("/"),e=t[t.length-1];if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let n=document.querySelector(".navbar-container");n&&n.remove();let o=document.querySelector(".logout-container");o&&o.remove();try{const t=await h(`https://localhost/api/users/${e}/game-history/`);if(!t.ok)throw new Error("Failed to fetch game history");const n=await t.json(),o=Array.isArray(n)?n:[],s=n.length>0?n[0].user:"",a=o.map((t=>{const e=t.winner_avatar,n=t.loser_avatar,o=t.local_game?"Locale":"Online",a=t.winner===s?"Victory":"Defeat",i=t.winner===s?"victory":"defeat";return`\n                <tr>\n                    <td>${new Date(t.date_time).toLocaleDateString()}</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="#/friendprofile/${t.winner}">\n\t\t\t\t\t\t\t<img src="${e}" alt="${t.winner}" class ="avatar"> ${t.winner}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<a href="#/friendprofile/${t.loser}">\n\t\t\t\t\t\t\t<img src="${n}" alt="${t.loser}" class ="avatar"> ${t.loser}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</td>\n                    <td class="${i}">${a}</td>\n                    <td>${o}</td>\n                    <td>${t.winner_score} - ${t.loser_score}</td>\n                </tr>\n            `})).join("");let i=document.querySelector("#section");if(i){i.innerHTML=`\n                <div class="main-container2 ga-hidden">\n                    <h1 class="title2">Match History</h1>\n                    <div class="history-container2">\n                        <button id="close-btn-pgh" class="close-btn2">\n                            &times;\n                        </button> \n                        <table class="history-table2">\n                            <thead>\n                                <tr>\n                                    <th>Date</th>\n                                    <th>Winner</th>\n                                    <th>Loser</th>\n                                    <th>Result</th>\n                                    <th>Game Mode</th>\n                                    <th>Score</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${a}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            `;const t=document.querySelector(".main-container2");t&&setTimeout((()=>{t.classList.add("ga-visible"),t.classList.remove("ga-hidden")}),10),document.getElementById("close-btn-pgh").addEventListener("click",(()=>{window.history.back()}))}}catch(t){console.error("Error fetching game history:",t)}})():"#/2fa"===t?(async()=>{let t=document.querySelector("#section");t.innerHTML='\n      <div class="container-2FA">\n          <div class="login-form-2FA">\n              <h1 class="title-2FA">ENTREZ LE CODE REÇU PAR MAIL</h1>\n              <input type="text" placeholder="Tapez le code ici">\n              <button class="button-2FA">renvoyer</button>\n          </div>\n      </div>\n      '})():"#/logout"===t?(async()=>{let t=document.querySelector("#section");if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let e=document.querySelector(".navbar-container");e&&e.remove();let n=document.querySelector(".logout-container");n&&n.remove(),t&&(t.innerHTML='   <div class="frame-LogOutMsg-container">\n            <div class="frame-LogOutMsg">\n                <p class="msg-confirmation">Êtes-vous sûr(e) de vouloir vous déconnecter ?</p>\n                <div class="button-logout">\n                    <button type="button" class="btn btn-success" id="logout-yes">Oui</button>\n                    <button type="button" class="btn btn-danger" id="logout-no">Non</button>\n                </div>\n            </div>\n        </div>\n    ',document.getElementById("logout-yes").addEventListener("click",O),document.getElementById("logout-no").addEventListener("click",(()=>{window.history.back()})))})():"#/chartemsg"===t?(async()=>{if(!await p())throw new Error("User is not authenticated");let t=document.querySelector("#section");if(!document.getElementById("root"))return void console.error("#root not found in the DOM");let e=document.querySelector(".navbar-container");e&&e.remove();let n=document.querySelector(".logout-container");n&&n.remove(),t&&(t.innerHTML='   <div class="charte-container">\n            <div class="charte-msg">\n                <h2 class="charte-title">Charte de confidentialite</h2>\n                <p>Bienvenue sur notre site !\n\nNous respectons votre vie privée et nous engageons à protéger vos données personnelles. Cette charte de confidentialité décrit comment nous collectons, utilisons et protégeons vos informations. \n\n1 - Nous collectons des informations telles que votre adresse e-mail ou votre pseudonyme. Ces informations sont recueillies lors de l\'inscription et de l\'utilisation régulière du site.\n\n2 - Votre adresse mail ou votre mot de passe ne seront jamais communiqués aux autre utilisateurs ou à des organisations tierces, et nous garantissons une politique de sécurité stricte pour protéger vos informations contre tout accès non autorisé. \n\n3 - La page paramètres du compte vous permet d\'accéder à vos données personnelles, de les modifier, ou de nous en demander la suppression immédiate. \n\nN.B. : Les utilisateurs inscrits grâce a leur compte sur l\'intranet de l\'Ecole 42 peuvent uniquement demander la suppression de leurs données, toute modification doit être effectuée directement sur votre espace à l\'adresse suivante: https://profile.intra.42.fr/\n\nMerci de votre confiance</p>\n                <div>\n                    <button type="button" class="btn btn-light" id="ok-button">ok</button>\n                </div>\n            </div>\n        </div>\n    ',document.getElementById("ok-button").addEventListener("click",(()=>{window.history.back()})))})():t.startsWith("#/friendprofile/")?(async()=>{if(!await p())throw new Error("User is not authenticated");let t=document.querySelector("#section");t.innerHTML="",t.append(F())})():e.innerHTML="<h1>Page not found</h1>",window.isInternalNavigation=!1},D=async()=>{let t=document.getElementById("root");if(!t)return void console.error("#root not found in the DOM");t.innerHTML="";const e=document.createElement("div");e.classList.add("navbar-supperposition"),e.append((()=>{let t=document.createElement("nav");return t.classList.add("navbar-container"),t.innerHTML='\n      <nav class="navbar-container">\n        <div class="container-fluid">\n          <div class="myNavbar d-none d-lg-flex">\n            <a class="nav-link" href="#/game"><i class="bi bi-controller" style="font-size: 4rem; color: white;"></i></a>\n            <a class="nav-link" href="#/dashboard"><i class="bi bi-person-fill" style="font-size: 4rem; color: white;"></i></a>\n            <a class="nav-link" href="#/settings"><i class="bi bi-gear-fill" style="font-size: 4rem; color: white;"></i></a>\n            <a class="nav-link" href="#/aboutus"><i class="bi bi-info-circle" style="font-size: 4rem; color: white;"></i></a>\n          </div>\n        </div>\n      </nav>\n\n      <nav class="navbar-container-sm">\n         <div class="myNavbar-sm d-flex d-lg-none navSm">\n          <div class="navbar">\n            <div class="container-fluid">\n              <a class="navbar-brand" href="#"></a>\n                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo02"\n                  aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">\n                  <span class="navbar-toggler-icon"></span>\n                </button>\n              <div class="collapse navbar-collapse" id="navbarTogglerDemo02">\n                <ul class="navbar-nav">\n                  <li class="nav-item">\n                    <a class="nav-link" active href="#/game">Jeu</a>\n                  </li>\n                  <li class="nav-item">\n                    <a class="nav-link" aria-current="page" href="#/dashboard">Mon profil</a>\n                  </li>\n                  <li class="nav-item">\n                    <a class="nav-link" aria-current="page" href="#/settings">Paramètres</a>\n                  </li>\n                  <li class="nav-item">\n                    <a class="nav-link" aria-current="page" href="#/aboutus">À propos de nous</a>\n                  </li>\n                     <li class="nav-item">\n                    <a class="nav-link" aria-current="page" href="#/logout">Déconnexion</a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </nav>\n\n  ',window.addEventListener("hashchange",o),o(),t})()),e.append((()=>{let t=document.createElement("div");return t.classList.add("logout-container"),t.innerHTML=' \n        <a class="nav-link d-none d-lg-flex" href="#/logout">\n            <i class="bi bi-box-arrow-right"></i>\n        </a>\n    ',t})()),t.append(e),t.append((()=>{let t=document.createElement("main");return t.id="section",t})()),window.location.hash||(window.location.hash="#/"),await P()};window.isInternalNavigation=!1,document.addEventListener("DOMContentLoaded",(function(){window.isInternalNavigation=!1,D()})),window.addEventListener("hashchange",D)}},n={};function o(t){var s=n[t];if(void 0!==s)return s.exports;var a=n[t]={exports:{}};return e[t](a,a.exports,o),a.exports}o.m=e,t=[],o.O=(e,n,s,a)=>{if(!n){var i=1/0;for(d=0;d<t.length;d++){for(var[n,s,a]=t[d],r=!0,l=0;l<n.length;l++)(!1&a||i>=a)&&Object.keys(o.O).every((t=>o.O[t](n[l])))?n.splice(l--,1):(r=!1,a<i&&(i=a));if(r){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[n,s,a]},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.p="/",(()=>{var t={792:0};o.O.j=e=>0===t[e];var e=(e,n)=>{var s,a,[i,r,l]=n,c=0;if(i.some((e=>0!==t[e]))){for(s in r)o.o(r,s)&&(o.m[s]=r[s]);if(l)var d=l(o)}for(e&&e(n);c<i.length;c++)a=i[c],o.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return o.O(d)},n=self.webpackChunkasset=self.webpackChunkasset||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var s=o.O(void 0,[964],(()=>o(980)));s=o.O(s)})();